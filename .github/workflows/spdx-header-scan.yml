name: Check for SPDX headers

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  check-spdx:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Check for SPDX headers in tracked files
        run: |
          echo "üîç Scanning for SPDX headers..."
          MISSING=0
          FILES=$(git ls-files '*.md' '*.yml' '*.py' '*.js' '*.ts' '*.html' '*.css')
          for file in $FILES; do
            if ! grep -q "SPDX-License-Identifier:" "$file"; then
              echo "üö´ Missing SPDX header in: $file"
              MISSING=1
            fi
          done

          if [ "$MISSING" -ne 0 ]; then
            echo "‚ùå Some files are missing SPDX headers. Fix and retry."
            exit 1
          else
            echo "‚úÖ All files passed SPDX header check."
          fi
